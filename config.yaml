# Crust Configuration

server:
  port: 9090
  log_level: info    # debug, info, warn, error
  no_color: false

# Upstream target (where to forward requests)
upstream:
  url: "https://openrouter.ai/api"  # Base URL (client sends /v1/chat/completions)
  timeout: 300                      # seconds

# Unified storage (SQLCipher encrypted SQLite)
storage:
  db_path: "./crust.db"
  encryption_key: ""        # SQLCipher key (empty = no encryption)

# Management API (Unix domain socket, auto-derived from proxy port)
api:
  socket_path: ""   # default: ~/.crust/crust-api-{proxyPort}.sock

# Telemetry (writes to SQLite via storage)
telemetry:
  enabled: false
  service_name: "crust"
  sample_rate: 1.0

# Security (Tool Call Interception)
security:
  enabled: true
  buffer_streaming: true      # Buffer streaming responses for security evaluation (default: true)
  max_buffer_events: 1000     # Maximum SSE events to buffer
  buffer_timeout: 60          # Buffer timeout in seconds
  block_mode: remove          # "remove" (delete tool calls) or "replace" (substitute with echo command)

# Rules Engine
rules:
  enabled: true
  user_dir: ""              # default: ~/.crust/rules.d
  disable_builtin: false    # set true to disable embedded security rules
  watch: true               # enable hot reload via file watching

# OS Sandbox (Layer 2)
sandbox:
  enabled: false            # Enable OS-level sandbox (Landlock on Linux, Seatbelt on macOS)
